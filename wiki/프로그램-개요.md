# 프로그램 개요

miniRT는 42 School 프로젝트로 개발된 고성능 레이 트레이싱 렌더러입니다. C 언어와 MinilibX 라이브러리를 사용하여 3D 장면을 사실적인 2D 이미지로 렌더링합니다.

---

## 🎯 프로젝트 목표

### 교육적 목표
- **광선 추적(Ray Tracing) 이해** - 컴퓨터 그래픽스의 기본 원리 학습
- **3D 수학 적용** - 벡터, 행렬, 기하학 연산 실습
- **C 프로그래밍 숙련** - 저수준 프로그래밍 및 최적화
- **알고리즘 설계** - 효율적인 자료구조 및 알고리즘 구현

### 기술적 목표
- **42 Norminette 준수** - 엄격한 코딩 스타일 규칙 준수
- **메모리 안전성** - 메모리 누수 및 버그 제로
- **성능 최적화** - BVH를 통한 렌더링 속도 개선
- **사용자 경험** - 실시간 인터랙티브 컨트롤

---

## ✨ 주요 기능

### 1. 렌더링 기능

#### 지원 객체
- **구체 (Sphere)**
  - 완전한 광선-구체 교차 검사
  - 정확한 법선 벡터 계산
  - 중심점 및 반지름 설정

- **평면 (Plane)**
  - 무한 평면 렌더링
  - 법선 벡터 기반 방향 설정
  - 바닥, 벽 등 배경 표현

- **원기둥 (Cylinder)**
  - 유한 높이 원기둥
  - 양쪽 캡(Cap) 포함
  - 축 방향 벡터로 회전 가능

#### 조명 모델
- **Phong 조명 모델**
  - **Ambient (주변광)**: 기본 밝기
  - **Diffuse (난반사)**: Lambert 코사인 법칙
  - **Specular (정반사)**: 광택 효과 (shininess = 32)

- **그림자 시스템**
  - **Soft Shadows**: 다중 샘플링 (4x4 = 16 samples)
  - **적응형 Shadow Bias**: Shadow Acne 방지
  - **정확한 가시성 검사**: 광원과 객체 사이 차폐 확인

### 2. 성능 최적화

#### BVH (Bounding Volume Hierarchy)
- **공간 가속 구조**: 광선-객체 교차 검사 최적화
- **AABB 기반**: Axis-Aligned Bounding Box 사용
- **재귀적 분할**: 최적의 이진 트리 구조
- **성능 향상**: 복잡한 장면에서 10-100배 빠름

#### 적응형 품질 제어
- **인터랙션 감지**: 키 입력 시 품질 자동 조정
- **그림자 샘플 감소**: 실시간 이동 시 1 sample로 축소
- **빠른 응답**: 부드러운 사용자 경험

### 3. 인터랙티브 기능

#### 카메라 제어
- **6자유도 이동**: W/A/S/D/Q/Z
- **피치 회전**: E/C (위/아래)
- **위치 리셋**: S (초기 위치로)

#### 객체 조작
- **선택**: [ ] 키로 순환
- **3축 이동**: R/T (X), F/G (Y), V/B (Z)
- **실시간 업데이트**: 즉시 재렌더링

#### 광원 조작
- **3축 이동**: Insert/Delete (X), Home/End (Y), PageUp/PageDown (Z)
- **조명 효과**: 실시간 그림자 및 반사 변화

#### HUD 시스템
- **장면 정보**: 객체 수, 광원 위치, 카메라 위치
- **선택 객체**: 타입, 위치, 색상, 크기
- **성능 메트릭**: FPS, 렌더 시간, BVH 통계
- **키 가이드**: 조작 방법 표시

---

## 🏗️ 시스템 아키텍처

### 모듈 구조

```
miniRT
├── 파싱 모듈 (Parser)
│   ├── 파일 읽기
│   ├── 토큰 분석
│   ├── 객체 생성
│   └── 검증
│
├── 렌더링 엔진 (Render Engine)
│   ├── 광선 생성 (Ray Generation)
│   ├── 교차 검사 (Intersection)
│   ├── 조명 계산 (Lighting)
│   └── 그림자 캐스팅 (Shadow)
│
├── 공간 최적화 (Spatial)
│   ├── BVH 빌드
│   ├── AABB 계산
│   └── 트리 순회
│
├── 수학 라이브러리 (Math)
│   ├── 벡터 연산
│   ├── 행렬 변환
│   └── 유틸리티
│
├── HUD 시스템 (HUD)
│   ├── 정보 표시
│   ├── 키 가이드
│   └── 성능 메트릭
│
└── 윈도우 관리 (Window)
    ├── 이벤트 처리
    ├── 키보드 입력
    └── 화면 출력
```

### 렌더링 파이프라인

```
1. 초기화
   ├── 장면 파일 파싱
   ├── BVH 구축
   └── 윈도우 생성

2. 메인 루프
   ├── 이벤트 처리
   │   ├── 키보드 입력
   │   ├── 카메라/객체/광원 업데이트
   │   └── 품질 조정
   │
   ├── 렌더링
   │   ├── 각 픽셀마다:
   │   │   ├── 광선 생성
   │   │   ├── BVH 순회 (교차 검사)
   │   │   ├── 최근접 객체 탐색
   │   │   └── 조명 계산
   │   │       ├── Ambient
   │   │       ├── Diffuse
   │   │       ├── Specular
   │   │       └── Shadow (Soft)
   │   └── 픽셀 색상 결정
   │
   ├── HUD 렌더링
   │   ├── 반투명 배경
   │   ├── 텍스트 정보
   │   └── 키 가이드
   │
   └── 화면 출력

3. 종료
   ├── 메모리 해제
   └── 윈도우 종료
```

---

## 📊 기술 사양

### 렌더링 설정
- **해상도**: 800x600 (기본)
- **FOV**: 0-180° (가변)
- **광선 반사**: 1회 (직접 조명만)
- **그림자 샘플**: 16개 (4x4 그리드)
- **Specular Shininess**: 32

### 성능 특성
- **단순 장면** (< 10 객체): 30-60 FPS
- **중간 장면** (10-50 객체): 15-30 FPS
- **복잡 장면** (> 50 객체): 5-15 FPS (BVH 사용 시)

### 메모리 사용
- **기본**: < 10 MB
- **복잡 장면**: < 50 MB
- **BVH 오버헤드**: 객체당 ~200 bytes

---

## 🎓 학습 포인트

### 컴퓨터 그래픽스
1. **광선 추적**: 광선-객체 교차 검사 알고리즘
2. **조명 모델**: Phong 반사 모델 이해
3. **그림자**: Soft shadow 구현 기법
4. **공간 최적화**: BVH, AABB 자료구조

### C 프로그래밍
1. **메모리 관리**: malloc/free, 누수 방지
2. **구조체 설계**: 데이터 모델링
3. **함수 포인터**: 다형성 구현
4. **최적화**: 캐싱, 인라이닝

### 수학
1. **벡터 연산**: 내적, 외적, 정규화
2. **기하학**: 직선-평면/구/원기둥 교차
3. **선형대수**: 좌표 변환, 직교 기저

---

## 🔬 프로젝트 제약사항

### 42 Norminette 규칙
- 함수당 최대 25줄
- 파일당 최대 5개 함수
- 함수 파라미터 최대 4개
- 금지된 키워드: for, do-while, switch 등

### 허용된 함수
- open, close, read, write
- malloc, free
- perror, strerror, exit
- math 라이브러리 (-lm)
- MinilibX 함수

### 금지 사항
- 표준 라이브러리 (printf 제외)
- 외부 라이브러리 (MinilibX 제외)
- 전역 변수

---

## 🔗 관련 문서

- [빠른 시작 가이드](빠른-시작-가이드.md)
- [레이 트레이싱 알고리즘](레이-트레이싱-알고리즘.md)
- [조명 시스템](조명-시스템.md)
- [개발 가이드](개발-가이드.md)

---

**Last Updated**: 2026-01-06  
**Version**: 2.0.0
